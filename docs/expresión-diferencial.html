<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Expresión diferencial | Proyecto final RNA-seq</title>
  <meta name="description" content="Chapter 7 Expresión diferencial | Proyecto final RNA-seq" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Expresión diferencial | Proyecto final RNA-seq" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Expresión diferencial | Proyecto final RNA-seq" />
  
  
  

<meta name="author" content="Salvador González Juárez" />


<meta name="date" content="2021-03-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="normalización-de-datos.html"/>
<link rel="next" href="conclusiones.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RNA-seq</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> <span style="color:darkblue">Proyecto</span></a></li>
<li class="chapter" data-level="2" data-path="especificaciones.html"><a href="especificaciones.html"><i class="fa fa-check"></i><b>2</b> <span style="color:orange">Especificaciones:</span></a></li>
<li class="chapter" data-level="3" data-path="proyecto-escogido.html"><a href="proyecto-escogido.html"><i class="fa fa-check"></i><b>3</b> <span style="color:orange">Proyecto escogido:</span></a></li>
<li class="chapter" data-level="4" data-path="datos-de-srp115956.html"><a href="datos-de-srp115956.html"><i class="fa fa-check"></i><b>4</b> <span1 style="color:orange">Datos de SRP115956</span></a></li>
<li class="chapter" data-level="5" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html"><i class="fa fa-check"></i><b>5</b> <span style="color:orange">Limpieza de datos</span></a></li>
<li class="chapter" data-level="6" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html"><i class="fa fa-check"></i><b>6</b> <span style="color:orange">Normalización de datos</span></a></li>
<li class="chapter" data-level="7" data-path="expresión-diferencial.html"><a href="expresión-diferencial.html"><i class="fa fa-check"></i><b>7</b> <span style="color:orange">Expresión diferencial</span></a></li>
<li class="chapter" data-level="8" data-path="conclusiones.html"><a href="conclusiones.html"><i class="fa fa-check"></i><b>8</b> <span style="color:orange">Conclusiones</span></a></li>
<li class="chapter" data-level="9" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i><b>9</b> <span style="color:orange">Referencias</span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Proyecto final RNA-seq</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="expresión-diferencial" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> <span style="color:orange">Expresión diferencial</span></h1>
<p>A continuación, se realizó un análisis mediante gráficas de tipo <em>boxplot</em>, el cual es útil para visualizar la diferencia entre la expresión de las muestras bajo distintas condiciones. Analicé la diferencia de expresión entre las muestras que tenían MDD y las que no; las muestras de mujeres y las de hombres; y entre individuos que se suicidaron y los que murieron de otras formas. Existe poca diferencia entre la expresión diferencial de cada uno de los casos, por lo que un análisis más exhaustivo es necesario.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="expresión-diferencial.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importa una libreria para generar boxplot</span></span>
<span id="cb67-2"><a href="expresión-diferencial.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb67-3"><a href="expresión-diferencial.html#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="expresión-diferencial.html#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafica la expresion diferencial entre las condiciones MDD y no MDD</span></span>
<span id="cb67-5"><a href="expresión-diferencial.html#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">as.data.frame</span>(<span class="fu">colData</span>(rse_gene)), <span class="fu">aes</span>(<span class="at">y =</span> assigned_gene_prop, <span class="at">x =</span> sra_attribute.phenotype)) <span class="sc">+</span></span>
<span id="cb67-6"><a href="expresión-diferencial.html#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb67-7"><a href="expresión-diferencial.html#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb67-8"><a href="expresión-diferencial.html#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Assigned Gene Prop&quot;</span>) <span class="sc">+</span></span>
<span id="cb67-9"><a href="expresión-diferencial.html#cb67-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Phenotype&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="expresión-diferencial.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafica la expresion diferencial entre las condiciones hombre y mujer</span></span>
<span id="cb68-2"><a href="expresión-diferencial.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">as.data.frame</span>(<span class="fu">colData</span>(rse_gene)), <span class="fu">aes</span>(<span class="at">y =</span> assigned_gene_prop, <span class="at">x =</span> sra_attribute.gender)) <span class="sc">+</span></span>
<span id="cb68-3"><a href="expresión-diferencial.html#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb68-4"><a href="expresión-diferencial.html#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb68-5"><a href="expresión-diferencial.html#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Assigned Gene Prop&quot;</span>) <span class="sc">+</span></span>
<span id="cb68-6"><a href="expresión-diferencial.html#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Gender&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="expresión-diferencial.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafica la expresion diferencial entre las condiciones suicida y no suicida</span></span>
<span id="cb69-2"><a href="expresión-diferencial.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">as.data.frame</span>(<span class="fu">colData</span>(rse_gene)), <span class="fu">aes</span>(<span class="at">y =</span> assigned_gene_prop, <span class="at">x =</span> death)) <span class="sc">+</span></span>
<span id="cb69-3"><a href="expresión-diferencial.html#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb69-4"><a href="expresión-diferencial.html#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb69-5"><a href="expresión-diferencial.html#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Assigned Gene Prop&quot;</span>) <span class="sc">+</span></span>
<span id="cb69-6"><a href="expresión-diferencial.html#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Cause of death&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Generé el modelo estadistico de acuerdo a las variables previamente mencionadas. Además, señalo a cuál instancia de las variables apuntan cada análisis. Estas instancias son MDD, hombre y suicida, respectivamente.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="expresión-diferencial.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar el modelo linear estadistico</span></span>
<span id="cb70-2"><a href="expresión-diferencial.html#cb70-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> sra_attribute.phenotype <span class="sc">+</span> sra_attribute.gender <span class="sc">+</span> death <span class="sc">+</span> assigned_gene_prop,</span>
<span id="cb70-3"><a href="expresión-diferencial.html#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">colData</span>(rse_gene))</span>
<span id="cb70-4"><a href="expresión-diferencial.html#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="expresión-diferencial.html#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Observar las variables que componen el modelo</span></span>
<span id="cb70-6"><a href="expresión-diferencial.html#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mod)</span></code></pre></div>
<pre><code>## [1] &quot;(Intercept)&quot;                &quot;sra_attribute.phenotypeMDD&quot;
## [3] &quot;sra_attribute.gendermale&quot;   &quot;deathsuicide&quot;              
## [5] &quot;assigned_gene_prop&quot;</code></pre>
<p>Usando un modelo de regresión lineal, es posible obtener estimados de la desviación estandar. La siguiente gráfica sintetiza las desviaciones estándar y valor de expresión logarítmica para cada gen. La forma que toma la curva roja indica que los datos son lo suficientemente robustos como para avanzar en el análisis.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="expresión-diferencial.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar la grafica para visualizar la desviacion estandar</span></span>
<span id="cb72-2"><a href="expresión-diferencial.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;limma&quot;</span>)</span>
<span id="cb72-3"><a href="expresión-diferencial.html#cb72-3" aria-hidden="true" tabindex="-1"></a>vGene <span class="ot">&lt;-</span> <span class="fu">voom</span>(dge, mod, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Ahora, genero el modelo de la regresión lineal y muestro la cantidad de genes que poseen una expresión diferencial significativa. El resultado son 28 de 63,828 genes.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="expresión-diferencial.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar el modelo de regresion lineal</span></span>
<span id="cb73-2"><a href="expresión-diferencial.html#cb73-2" aria-hidden="true" tabindex="-1"></a>eb_results <span class="ot">&lt;-</span> <span class="fu">eBayes</span>(<span class="fu">lmFit</span>(vGene))</span>
<span id="cb73-3"><a href="expresión-diferencial.html#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="expresión-diferencial.html#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Indicar el coeficiente del modelo, que en este caso es la variable de interes </span></span>
<span id="cb73-5"><a href="expresión-diferencial.html#cb73-5" aria-hidden="true" tabindex="-1"></a>de_results <span class="ot">&lt;-</span> <span class="fu">topTable</span>(</span>
<span id="cb73-6"><a href="expresión-diferencial.html#cb73-6" aria-hidden="true" tabindex="-1"></a>    eb_results,</span>
<span id="cb73-7"><a href="expresión-diferencial.html#cb73-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">coef =</span> <span class="dv">2</span>,</span>
<span id="cb73-8"><a href="expresión-diferencial.html#cb73-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">number =</span> <span class="fu">nrow</span>(rse_gene),</span>
<span id="cb73-9"><a href="expresión-diferencial.html#cb73-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sort.by =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb73-10"><a href="expresión-diferencial.html#cb73-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-11"><a href="expresión-diferencial.html#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los genes diferencialmente expresados entre control y MDD con FDR &lt; 5%</span></span>
<span id="cb73-12"><a href="expresión-diferencial.html#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(de_results<span class="sc">$</span>adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
## 46827    38</code></pre>
<p>Ahora, utilizo una gráfica con la cual puedo visualizar el cambio en los niveles de expresión entre las muestras MDD y no MDD. Los valores positivos indican que la expresión es mas alta en el caso MDD y los valores negativos indican que es más alto en el caso no MDD.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="expresión-diferencial.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar los resultados estadísticos</span></span>
<span id="cb75-2"><a href="expresión-diferencial.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotMA</span>(eb_results, <span class="at">coef =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Mediante el uso de una gráfica de tipo <em>volcano</em>, se indican los genes con mayor expresión diferencial y con mejor valor de p-value.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="expresión-diferencial.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">volcanoplot</span>(eb_results, <span class="at">coef =</span> <span class="dv">2</span>, <span class="at">highlight =</span> <span class="dv">5</span>, <span class="at">names =</span> de_results<span class="sc">$</span>gene_name)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>A continuación, se muestra la información de los genes con mayor expresión diferencial. Es importante remarcar que hay dos genes llamados TRPM1, pero el significativo solo es uno.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="expresión-diferencial.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar la informacion de los genes</span></span>
<span id="cb77-2"><a href="expresión-diferencial.html#cb77-2" aria-hidden="true" tabindex="-1"></a>de_results[de_results<span class="sc">$</span>gene_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;PAX8-AS1&quot;</span>, <span class="st">&quot;TRPM1&quot;</span>, <span class="st">&quot;FAM182A&quot;</span>, <span class="st">&quot;PAX8&quot;</span>, <span class="st">&quot;NKAPP1&quot;</span>), ]</span></code></pre></div>
<pre><code>##                    source type score phase            gene_id
## ENSG00000134160.13 HAVANA gene  7454    NA ENSG00000134160.13
## ENSG00000189223.14 HAVANA gene 17274    NA ENSG00000189223.14
## ENSG00000125618.16 HAVANA gene  7400    NA ENSG00000125618.16
## ENSG00000125804.13 HAVANA gene  5787    NA ENSG00000125804.13
## ENSG00000233382.6  HAVANA gene  3222    NA  ENSG00000233382.6
##                                           gene_type gene_name level
## ENSG00000134160.13                   protein_coding     TRPM1     1
## ENSG00000189223.14             processed_transcript  PAX8-AS1     1
## ENSG00000125618.16                   protein_coding      PAX8     1
## ENSG00000125804.13             processed_transcript   FAM182A     2
## ENSG00000233382.6  transcribed_processed_pseudogene    NKAPP1     2
##                              havana_gene               tag     logFC    AveExpr
## ENSG00000134160.13  OTTHUMG00000129267.5        ncRNA_host 1.8618999 -1.7911180
## ENSG00000189223.14  OTTHUMG00000153340.8 overlapping_locus 1.5808862  2.9641547
## ENSG00000125618.16 OTTHUMG00000128529.11              &lt;NA&gt; 1.4852405 -0.3744210
## ENSG00000125804.13  OTTHUMG00000032144.2              &lt;NA&gt; 0.7455656  0.2053713
## ENSG00000233382.6   OTTHUMG00000022295.5 overlapping_locus 0.3678170  4.5605076
##                           t      P.Value    adj.P.Val        B
## ENSG00000134160.13 5.821262 2.323090e-08 0.0004207514 6.828719
## ENSG00000189223.14 5.869610 1.813457e-08 0.0004207514 9.003623
## ENSG00000125618.16 5.225435 4.386866e-07 0.0045123406 5.387529
## ENSG00000125804.13 5.792264 2.693384e-08 0.0004207514 8.186189
## ENSG00000233382.6  5.121715 7.154427e-07 0.0045123406 5.639558</code></pre>
<p>En la siguiente gráfica de tipo <em>heatmap</em> se observa la expresión de los genes dependiendo de todas las condiciones que se analizaron en el modelo. La información solo se extrajo de los primeros 25 genes mas significativos.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="expresión-diferencial.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraer valores de los genes de interes</span></span>
<span id="cb79-2"><a href="expresión-diferencial.html#cb79-2" aria-hidden="true" tabindex="-1"></a>exprs_heatmap <span class="ot">&lt;-</span> vGene<span class="sc">$</span>E[<span class="fu">rank</span>(de_results<span class="sc">$</span>adj.P.Val) <span class="sc">&lt;=</span> <span class="dv">25</span>, ]</span>
<span id="cb79-3"><a href="expresión-diferencial.html#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="expresión-diferencial.html#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear una tabla con informacion de las muestras y con nombres de columnas mas amigables</span></span>
<span id="cb79-5"><a href="expresión-diferencial.html#cb79-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">colData</span>(rse_gene)[, </span>
<span id="cb79-6"><a href="expresión-diferencial.html#cb79-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">&quot;sra_attribute.gender&quot;</span>, <span class="st">&quot;death&quot;</span>, <span class="st">&quot;sra_attribute.phenotype&quot;</span>)])</span>
<span id="cb79-7"><a href="expresión-diferencial.html#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Gender&quot;</span>, <span class="st">&quot;Cause of death&quot;</span>, <span class="st">&quot;Phenotype&quot;</span>)</span>
<span id="cb79-8"><a href="expresión-diferencial.html#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="expresión-diferencial.html#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="expresión-diferencial.html#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Indicar el nombre de cada uno de los genes</span></span>
<span id="cb79-11"><a href="expresión-diferencial.html#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(exprs_heatmap) <span class="ot">&lt;-</span> <span class="fu">rowRanges</span>(rse_gene)<span class="sc">$</span>gene_name[<span class="fu">match</span>(<span class="fu">rownames</span>(exprs_heatmap), <span class="fu">rownames</span>(rse_gene))]</span>
<span id="cb79-12"><a href="expresión-diferencial.html#cb79-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-13"><a href="expresión-diferencial.html#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Importar la libreria requerida para graficar el heatmap</span></span>
<span id="cb79-14"><a href="expresión-diferencial.html#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;pheatmap&quot;</span>)</span>
<span id="cb79-15"><a href="expresión-diferencial.html#cb79-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-16"><a href="expresión-diferencial.html#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el heatmap</span></span>
<span id="cb79-17"><a href="expresión-diferencial.html#cb79-17" aria-hidden="true" tabindex="-1"></a><span class="fu">pheatmap</span>(</span>
<span id="cb79-18"><a href="expresión-diferencial.html#cb79-18" aria-hidden="true" tabindex="-1"></a>    exprs_heatmap,</span>
<span id="cb79-19"><a href="expresión-diferencial.html#cb79-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">cluster_rows =</span> <span class="cn">TRUE</span>,</span>
<span id="cb79-20"><a href="expresión-diferencial.html#cb79-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">cluster_cols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb79-21"><a href="expresión-diferencial.html#cb79-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_rownames =</span> <span class="cn">TRUE</span>,</span>
<span id="cb79-22"><a href="expresión-diferencial.html#cb79-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_colnames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb79-23"><a href="expresión-diferencial.html#cb79-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation_col =</span> df,</span>
<span id="cb79-24"><a href="expresión-diferencial.html#cb79-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontsize_row =</span> <span class="dv">6</span>,</span>
<span id="cb79-25"><a href="expresión-diferencial.html#cb79-25" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Por último, grafique la expresión diferencial dependiendo de la categoria a la que pertenecen las muestras. En el caso entre mujeres y hombres existe una gran diferencia de genes diferencialmente expresados, como lo indicaban en el estudio. Esto se interpreta gracias a la formación de clusters correspondientes a cada instancia de las variables en la siguiente gráfica.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="expresión-diferencial.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importar una libreria requerida para asignar colores</span></span>
<span id="cb80-2"><a href="expresión-diferencial.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;RColorBrewer&quot;</span>)</span>
<span id="cb80-3"><a href="expresión-diferencial.html#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="expresión-diferencial.html#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir los valores de genero a colores</span></span>
<span id="cb80-5"><a href="expresión-diferencial.html#cb80-5" aria-hidden="true" tabindex="-1"></a>col.gender <span class="ot">&lt;-</span> df<span class="sc">$</span>Gender</span>
<span id="cb80-6"><a href="expresión-diferencial.html#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(col.gender) <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">nlevels</span>(col.gender), <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in brewer.pal(nlevels(col.gender), &quot;Set1&quot;): minimal value for n is 3, returning requested palette with 3 different levels</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="expresión-diferencial.html#cb82-1" aria-hidden="true" tabindex="-1"></a>col.gender <span class="ot">&lt;-</span> <span class="fu">as.character</span>(col.gender)</span>
<span id="cb82-2"><a href="expresión-diferencial.html#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="expresión-diferencial.html#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="do">## MDS por genero</span></span>
<span id="cb82-4"><a href="expresión-diferencial.html#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotMDS</span>(vGene<span class="sc">$</span>E, <span class="at">labels =</span> df<span class="sc">$</span>Gender, <span class="at">col =</span> col.gender)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Sin embargo, encontre un panorama mucho menos informativo al analizar en el caso entre individuos con y sin MDD, y entre individuos que fueron suicidas y los que no. Se interpreta que no hay muchos genes diferencialmente expresados ya que no se forman clusters correspondientes a cada instancia de la variable. Esto se observa en las siguientes dos gráficas.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="expresión-diferencial.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Convertir los valores de MDD a colores</span></span>
<span id="cb83-2"><a href="expresión-diferencial.html#cb83-2" aria-hidden="true" tabindex="-1"></a>col.phenotype <span class="ot">&lt;-</span> df<span class="sc">$</span>Phenotype</span>
<span id="cb83-3"><a href="expresión-diferencial.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(col.phenotype) <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">nlevels</span>(col.phenotype), <span class="st">&quot;Dark2&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in brewer.pal(nlevels(col.phenotype), &quot;Dark2&quot;): minimal value for n is 3, returning requested palette with 3 different levels</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="expresión-diferencial.html#cb85-1" aria-hidden="true" tabindex="-1"></a>col.phenotype <span class="ot">&lt;-</span> <span class="fu">as.character</span>(col.phenotype)</span>
<span id="cb85-2"><a href="expresión-diferencial.html#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="expresión-diferencial.html#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="do">## MDS por MDD</span></span>
<span id="cb85-4"><a href="expresión-diferencial.html#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotMDS</span>(vGene<span class="sc">$</span>E, <span class="at">labels =</span> df<span class="sc">$</span>Phenotype, <span class="at">col =</span> col.phenotype)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="expresión-diferencial.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Conviertiendo los valores de Sex a colores</span></span>
<span id="cb86-2"><a href="expresión-diferencial.html#cb86-2" aria-hidden="true" tabindex="-1"></a>col.death <span class="ot">&lt;-</span> df<span class="sc">$</span><span class="st">`</span><span class="at">Cause of death</span><span class="st">`</span></span>
<span id="cb86-3"><a href="expresión-diferencial.html#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(col.death) <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">nlevels</span>(col.death), <span class="st">&quot;Set2&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in brewer.pal(nlevels(col.death), &quot;Set2&quot;): minimal value for n is 3, returning requested palette with 3 different levels</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="expresión-diferencial.html#cb88-1" aria-hidden="true" tabindex="-1"></a>col.death <span class="ot">&lt;-</span> <span class="fu">as.character</span>(col.death)</span>
<span id="cb88-2"><a href="expresión-diferencial.html#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="expresión-diferencial.html#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="do">## MDS por sexo</span></span>
<span id="cb88-4"><a href="expresión-diferencial.html#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotMDS</span>(vGene<span class="sc">$</span>E, <span class="at">labels =</span> df<span class="sc">$</span><span class="st">`</span><span class="at">Cause of death</span><span class="st">`</span>, <span class="at">col =</span> col.death)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<hr />
</div>
            </section>

          </div>
        </div>
      </div>
<a href="normalización-de-datos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusiones.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Salvador04/ProyectoFinal_RNA-seq/edit/master/index.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Salvador04/ProyectoFinal_RNA-seq/blob/master/index.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
